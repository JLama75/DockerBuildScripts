Bootstrap: docker
From: continuumio/miniconda3:latest

%labels
    Author Jyoti Lama
    Version 1.0
    Description "Singularity container for Gene Burden pipeline: Regenie and VEP via Conda, everything else installed manually"

%environment
    export LC_ALL=C.UTF-8
    export LANG=C.UTF-8


%post
    export DEBIAN_FRONTEND=noninteractive
    export TZ=America/New_York
    ln -snf /usr/share/zoneinfo/$TZ /etc/localtime
    
    echo $TZ > /etc/timezone

    apt-get update && apt-get upgrade -y
    apt-get install -y \
        build-essential \
        wget \
        curl \
        unzip \
        git \
        r-base \
        r-base-dev \
        libcurl4-openssl-dev \
        libssl-dev \
        libxml2-dev \
        perl \
        cpanminus \
        ca-certificates \
        locales


    # Python packages
    pip install --upgrade pip
    pip install seaborn==0.13.2 plotly==6.1.2 matplotlib==3.9.4 scikit-learn==1.6.1 statsmodels==0.14.4 xlsxwriter==3.2.3 pysnptools==0.5.13 nextflow==25.04.4

    # R packages
    Rscript -e "install.packages(c('dplyr','ggplot2','qqman','data.table','stringr','ggExtra','gridExtra','optparse','devtools'), repos='https://cloud.r-project.org')"
